---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
dataset <- read.csv('activity.csv')
head(dataset[is.na(dataset$steps)==FALSE & dataset$steps > 0,], n=10)
typeof(dataset)
typeof(dataset$steps)
typeof(dataset$date)
typeof(dataset$interval)
```

## What is mean total number of steps taken per day?
Calculate the total number of steps taken per day.
```{r}
# Include the plyr library to be able to use the ddply function
library(plyr)
# Summarize the dataset by date
daily <- ddply(dataset, "date", summarize, total.steps = sum(steps))
head(daily, n=10)
```

Make a histogram of the total number of steps taken each day.
```{r}
hist(daily$total.steps, breaks=20)
```

Calculate and report the mean and median of the total number of steps taken per day.
```{r}
daily.mean <- mean(daily$total.steps, na.rm=TRUE)
daily.median <- median(daily$total.steps, na.rm=TRUE)
```
The mean daily steps taken is `r sprintf("%.2f", daily.mean)` and the median daily steps taken is `r daily.median`.

## What is the average daily activity pattern?
Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
# Import the ggplot library
library(ggplot2)
# Calculate a typical day by averaging the number of steps taken at each interval
typical.day <- ddply(dataset, "interval", summarize, avg.steps = mean(steps, na.rm=TRUE))
ggplot(data=typical.day, mapping=aes(x=interval, y=avg.steps)) + geom_line()
```

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
ordered <- arrange(typical.day, desc(avg.steps))
#strftime(ordered[1,1], format="%H%M")
```
The interval with the maximum number of steps is ```r ordered[1, 1]```.


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
